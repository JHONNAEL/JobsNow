---
import { actions } from 'astro:actions'
import ServiceCategoryCard from './ServiceCategoryCard.astro'

// Recupera la información de usuarios desde la base de datos
const { data: usersData, error: usersError } = await actions.findAllUsers()

// Redirige a una página 404 si ocurre algún error
if (usersError) return Astro.redirect('/404')

// Extrae la lista de usuarios
const { users } = usersData
---

<!-- Contenedor principal -->
<div class="px-6 py-12 w-full flex flex-col items-center gap-8 bg-gradient-to-r from-blue-50 to-white">

  <!-- Título principal -->
  <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 text-center">
    Conecta tus estudios con el empleo ideal.
  </h1>

  <!-- Barra de búsqueda -->
  <div class="bg-white w-full max-w-4xl p-6 rounded-2xl shadow-lg flex flex-col sm:flex-row items-center gap-4">
    <select
      class="w-full sm:w-auto py-3 px-4 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-600"
    >
      <option>Plomero</option>
      <option>Carpintero</option>
      <option>Albanil</option>
    </select>
    <input
      type="text"
      placeholder="Nombre trabajador"
      class="flex-1 py-3 px-4 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input
      type="text"
      placeholder="Calificacion"
      class="flex-1 py-3 px-4 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <button
      class="bg-green-500 text-white font-semibold py-3 px-6 rounded-lg hover:bg-green-200 transition flex items-center justify-center"
    >
      <span class="text-lg">🔍</span>
    </button>
  </div>

  <!-- Etiquetas de categorías -->
  <div class="flex flex-wrap gap-4 justify-center mt-4">
    <button class="bg-blue-100 text-blue-700 py-3 px-6 rounded-full text-base font-semibold hover:bg-blue-200 transition flex items-center gap-2">
      🌱 <span>Mas recientes</span>
    </button>
    <button class="bg-blue-100 text-blue-700 py-3 px-6 rounded-full text-base font-semibold hover:bg-blue-200 transition flex items-center gap-2">
      📅 <span>Caalificacion</span>
    </button>
    <button class="bg-blue-100 text-blue-700 py-3 px-6 rounded-full text-base font-semibold hover:bg-blue-200 transition flex items-center gap-2">
      💼 <span>Disponibles</span>
    </button>
  </div>

  <!-- Tarjetas de usuarios -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 w-full max-w-6xl mt-8">
    {
      users.map((user) => (
        <ServiceCategoryCard category={user} />
      ))
    }
  </div>
</div>
